
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Pure python extensions of the C++ micro-manager core">
      
      
      
        <link rel="canonical" href="https://pymmcore-plus.github.io/pymmcore-plus/guides/mda_engine/">
      
      
        <link rel="prev" href="../events/">
      
      
        <link rel="next" href="../custom_engine/">
      
      
        
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>The Acquisition Engine - pymmcore-plus</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="dark-blue" data-md-color-accent="dark-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-acquisition-engine" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pymmcore-plus" class="md-header__button md-logo" aria-label="pymmcore-plus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M176 0c-26.5 0-48 21.5-48 48v208c0 26.5 21.5 48 48 48h64c26.5 0 48-21.5 48-48v-64h32c70.7 0 128 57.3 128 128s-57.3 128-128 128H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h448c17.7 0 32-14.3 32-32s-14.3-32-32-32h-16.9c30.4-34 48.9-78.8 48.9-128 0-106-86-192-192-192h-32V48c0-26.5-21.5-48-48-48zm-56 352c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pymmcore-plus
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              The Acquisition Engine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="dark-blue" data-md-color-accent="dark-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/pymmcore-plus/pymmcore-plus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pymmcore-plus/pymmcore-plus
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../.." class="md-tabs__link">
          
  
  
  pymmcore-plus

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="/useq-schema/" class="md-tabs__link">
        
  
  
    
  
  useq-schema

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="/pymmcore-widgets/" class="md-tabs__link">
        
  
  
    
  
  pymmcore-widgets

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="/napari-micromanager/" class="md-tabs__link">
        
  
  
    
  
  napari-micromanager

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pymmcore-plus" class="md-nav__button md-logo" aria-label="pymmcore-plus" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M176 0c-26.5 0-48 21.5-48 48v208c0 26.5 21.5 48 48 48h64c26.5 0 48-21.5 48-48v-64h32c70.7 0 128 57.3 128 128s-57.3 128-128 128H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h448c17.7 0 32-14.3 32-32s-14.3-32-32-32h-16.9c30.4-34 48.9-78.8 48.9-128 0-106-86-192-192-192h-32V48c0-26.5-21.5-48-48-48zm-56 352c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg>

    </a>
    pymmcore-plus
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pymmcore-plus/pymmcore-plus" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    pymmcore-plus/pymmcore-plus
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    pymmcore-plus
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    pymmcore-plus
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" checked>
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events and Callbacks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    The Acquisition Engine
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    The Acquisition Engine
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-very-simple-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running a very simple sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-mdaevent-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        The MDAEvent object
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-multi-event-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        A multi-event sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-sequences-with-mdasequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building sequences with MDASequence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building sequences with MDASequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-two-channel-time-series" class="md-nav__link">
    <span class="md-ellipsis">
      
        A two-channel time series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-z-stack-at-three-positions" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Z-stack at three positions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-grid-of-z-stacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        A grid of Z-stacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skip-timepoints-or-z-stacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Skip timepoints or Z-stacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-note-on-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      
        A note on syntax
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-an-mda-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running an MDA sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-acquired-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Handling acquired data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cancelling-or-pausing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cancelling or Pausing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializing-mda-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Serializing MDA sequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-triggered-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardware-triggered sequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Acquisition Engines
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../event_driven_acquisition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Event-Driven Acquisition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../unicore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    UniMMCore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ipython_completion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IPython Tab Completion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" >
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/mda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multidimensional Acquisition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/integration-with-qt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Qt Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/context-set/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Set as a Context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/napari-micromanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Using with napari
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/following_changes_in_core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Follow changes in MMCore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/pycro-manager-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pycro-manager like API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/cmmcoreplus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CMMCorePlus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/mda/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Dimensional Acquisition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/device/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Device &amp; Property objects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration &amp; Groups
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Constants
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metadata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/unicore/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Experimental UniMMCore
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metadata Schema
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env_var/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environment Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Performance Profiling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="/useq-schema/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    useq-schema
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="/pymmcore-widgets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pymmcore-widgets
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="/napari-micromanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    napari-micromanager
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#running-a-very-simple-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running a very simple sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-mdaevent-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        The MDAEvent object
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-multi-event-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        A multi-event sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-sequences-with-mdasequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building sequences with MDASequence
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building sequences with MDASequence">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-two-channel-time-series" class="md-nav__link">
    <span class="md-ellipsis">
      
        A two-channel time series
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-z-stack-at-three-positions" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Z-stack at three positions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-grid-of-z-stacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        A grid of Z-stacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#skip-timepoints-or-z-stacks" class="md-nav__link">
    <span class="md-ellipsis">
      
        Skip timepoints or Z-stacks
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-note-on-syntax" class="md-nav__link">
    <span class="md-ellipsis">
      
        A note on syntax
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-an-mda-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running an MDA sequence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handling-acquired-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Handling acquired data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cancelling-or-pausing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cancelling or Pausing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serializing-mda-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Serializing MDA sequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hardware-triggered-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Hardware-triggered sequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Next steps
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="the-acquisition-engine">The Acquisition Engine<a class="headerlink" href="#the-acquisition-engine" title="Permanent link">#</a></h1>
<p>One of the key features of pymmcore-plus is the acquisition engine. This allows
you to define and execute a sequence of events. The sequence may be a typical
multi-dimensional acquisition (MDA), such as a z-stack across multiple channels,
stage positions, and time points; or it can be any custom sequence of events
that you define. It needn't even be a sequence of known length: you can define
an iterable or a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/queue.html#queue.Queue"><code>queue.Queue</code></a> of events that reacts to the results of
previous events, for event-driven "smart" microscopy.</p>
<p>The built-in acquisition engine will support many standard use-cases, but you
can also subclass and customize it, allowing arbitrary python code to be
executed at each step of the acquisition. This makes it possible to incorporate
custom hardware control (e.g. to control devices for which micro-manager has no
adapters), data analysis, or other logic into the experiment.</p>
<h2 id="running-a-very-simple-sequence">Running a very simple sequence<a class="headerlink" href="#running-a-very-simple-sequence" title="Permanent link">#</a></h2>
<p>To execute a sequence, you must:</p>
<ol>
<li>Create a <a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.CMMCorePlus"><code>CMMCorePlus</code></a> instance (and probably
   load a configuration file)</li>
<li>Pass an iterable of <a class="autorefs autorefs-external" href="https://pymmcore-plus.github.io/useq-schema/schema/event/#useq.MDAEvent"><code>useq.MDAEvent</code></a> objects to the
   <a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.run_mda"><code>run_mda()</code></a> method.</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDAEvent</span>

<span class="c1"># Create the core instance.</span>
<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>  <span class="c1"># (1)!</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>  <span class="c1"># (2)!</span>

<span class="c1"># Create a super-simple sequence, with one event</span>
<span class="n">mda_sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">MDAEvent</span><span class="p">()]</span> <span class="c1"># (3)!</span>

<span class="c1"># Run it!</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">run_mda</span><span class="p">(</span><span class="n">mda_sequence</span><span class="p">)</span>
</code></pre></div>
<ol>
<li>Here, we use the global
   <a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.instance"><code>CMMCorePlus.instance</code></a> singleton.</li>
<li>This loads the demo configuration by default. Pass in your own config file.
   See
   <a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.loadSystemConfiguration"><code>CMMCorePlus.loadSystemConfiguration</code></a></li>
<li>An experiment is just an iterable of <a class="autorefs autorefs-external" href="https://pymmcore-plus.github.io/useq-schema/schema/event/#useq.MDAEvent"><code>useq.MDAEvent</code></a> objects.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.run_mda"><code>CMMCorePlus.run_mda</code></a> is
a convenience method that runs the experiment in a separate thread. If you
want to run it in the main thread, use
<a class="autorefs autorefs-internal" href="../../api/mda/#pymmcore_plus.mda._runner.MDARunner.run"><code>CMMCorePlus.mda.run</code></a> directly.</p>
<div class="highlight"><pre><span></span><code><span class="n">mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
</code></pre></div>
</div>
<p>The code above will execute a single, very boring event! It will snap
one image (the default action of an <code>MDAEvent</code>) with the current exposure
time, channel, stage position, etc... and then stop.</p>
<p>Let's make it a little more interesting.</p>
<h2 id="the-mdaevent-object">The <code>MDAEvent</code> object<a class="headerlink" href="#the-mdaevent-object" title="Permanent link">#</a></h2>
<p>The <a class="autorefs autorefs-external" href="https://pymmcore-plus.github.io/useq-schema/schema/event/#useq.MDAEvent"><code>useq.MDAEvent</code></a> object is the basic building block of an experiment. It
is a relatively simple dataclass that defines a single action to be performed.
For complete details, see the <a href="https://pymmcore-plus.github.io/useq-schema/schema/event/">useq-schema
documentation</a>, but
some key attributes you might want to set are:</p>
<ul>
<li><strong>exposure</strong> (<code>float</code>): The exposure time (in milliseconds) to use for this
  event.</li>
<li><strong>channel</strong> (<code>str | dict[str, str]</code>): The configuration group to use. If a
  <code>dict</code>, it should have two keys: <code>group</code> and <code>config</code> (the configuration group
  and preset, respectively). If a <code>str</code>, it is assumed to be the name of a preset in
  the <code>Channel</code> group.</li>
<li><strong>x_pos</strong>, <strong>y_pos</strong>, <strong>z_pos</strong> (<code>float</code>): An <code>x</code>, <code>y</code>, and <code>z</code> stage position
  to use for this event.</li>
<li><strong>min_start_time</strong> (<code>float</code>): The minimum time to wait before starting this
  event.(in seconds, relative to the start of the experiment)</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Example</p>
<div class="highlight"><pre><span></span><code><span class="n">snap_a_dapi</span> <span class="o">=</span> <span class="n">MDAEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="n">exposure</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">1240</span><span class="p">)</span>
</code></pre></div>
<p><strong>NOTE:</strong> The name <code>"DAPI"</code> here must be a name of a
<a href="https://micro-manager.org/Micro-Manager_Configuration_Guide#configuration-presets">preset</a>
in your micro-manager "Channel" configuration group.</p>
</div>
<p>For any missing keys, the implied meaning is "use the current setting". For
example, an <code>MDAEvent</code> without an <code>x_pos</code> or a <code>y_pos</code> will use the current
stage position.</p>
<p>The implied "action" of an <code>MDAEvent</code> is to snap an image. But there are ways to
customize that, described later.</p>
<h2 id="a-multi-event-sequence">A multi-event sequence<a class="headerlink" href="#a-multi-event-sequence" title="Permanent link">#</a></h2>
<p>With our understanding of <code>MDAEvent</code> objects, we can now create a slightly more
interesting experiment. This one will snap four images: two channels at two
different stage positions.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDAEvent</span>

<span class="c1"># Create the core instance.</span>
<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>

<span class="c1"># Snap two channels at two positions</span>
<span class="n">mda_sequence</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">1240</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">1100</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">1240</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">1442</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">1099</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">channel</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;config&#39;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">1442</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mi">1099</span><span class="p">),</span>
<span class="p">]</span>

<span class="c1"># Run it!</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">run_mda</span><span class="p">(</span><span class="n">mda_sequence</span><span class="p">)</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Logs</p>
<p>If you run the code above, you will see some logs printed to the console
that look something like this:</p>
<div class="highlight"><pre><span></span><code>2023-08-12 16:37:50,694 - INFO - MDA Started: GeneratorMDASequence()
2023-08-12 16:37:50,695 - INFO - channel=Channel(config=&#39;DAPI&#39;) x_pos=1100.0 y_pos=1240.0
2023-08-12 16:37:50,881 - INFO - channel=Channel(config=&#39;FITC&#39;) x_pos=1100.0 y_pos=1240.0
2023-08-12 16:37:50,891 - INFO - channel=Channel(config=&#39;DAPI&#39;) x_pos=1442.0 y_pos=1099.0
2023-08-12 16:37:50,947 - INFO - channel=Channel(config=&#39;FITC&#39;) x_pos=1442.0 y_pos=1099.0
2023-08-12 16:37:50,958 - INFO - MDA Finished: GeneratorMDASequence()
</code></pre></div>
<p>See <a href="../logging/">logging</a> for more details on how to configure and review logs.</p>
</div>
<p>At this point, you might be thinking that constructing a sequence by hand is a
little tedious. And you'd be right! That's why we have the
<code>MDASequence</code> class.</p>
<h2 id="building-sequences-with-mdasequence">Building sequences with <code>MDASequence</code><a class="headerlink" href="#building-sequences-with-mdasequence" title="Permanent link">#</a></h2>
<p>For most standard multi-dimensional experiments, you will want to use
<a class="autorefs autorefs-external" href="https://pymmcore-plus.github.io/useq-schema/schema/sequence/#useq.MDASequence"><code>useq.MDASequence</code></a> to construct your sequence of events. It allows you to
declare a "plan" for each axis in your experiment (channels, time, z, etc...)
along with the order in which the axes should be iterated.</p>
<p>See the <a href="https://pymmcore-plus.github.io/useq-schema/schema/sequence/">useq-schema documentation</a>
for complete details, but let's look at how <code>MDASequence</code> can be used to
create a few common experiments.</p>
<h3 id="a-two-channel-time-series">A two-channel time series<a class="headerlink" href="#a-two-channel-time-series" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDASequence</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span> <span class="c1"># (1)!</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
<ol>
<li>10 loops, with a 2 second interval between each loop. See also, <a href="https://pymmcore-plus.github.io/useq-schema/schema/axes/#time-plans">additional
   time-plans</a>.</li>
</ol>
<details class="example">
<summary>output of <code>list(mda_sequence)</code></summary>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;DAPI&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">),</span> <span class="n">exposure</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">),</span>
<span class="p">]</span>
</code></pre></div>
</details>
<h3 id="a-z-stack-at-three-positions">A Z-stack at three positions<a class="headerlink" href="#a-z-stack-at-three-positions" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDASequence</span><span class="p">,</span> <span class="n">Position</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>  <span class="c1"># (1)!</span>
    <span class="n">stage_positions</span><span class="o">=</span><span class="p">[</span>  <span class="c1"># (2)!</span>
        <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
        <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
        <span class="n">Position</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div>
<ol>
<li>A 4-micron Z-stack with 0.5 micron steps, ranging around each position. See
   also, <a href="https://pymmcore-plus.github.io/useq-schema/schema/axes/#z-plans">additional
   z-plans</a>.</li>
<li>These are all valid ways to specify a <a href="https://pymmcore-plus.github.io/useq-schema/schema/axes/#useq.Position">stage
   position</a>.
   None of <code>x</code>, <code>y</code>, or <code>z</code> are required.</li>
</ol>
<details class="example">
<summary>output of <code>list(mda_sequence)</code></summary>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">18.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">18.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">19.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">19.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">20.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">20.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">21.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">21.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">22.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">48.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">48.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">49.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">49.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">50.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">50.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">51.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">51.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">30.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">40.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">52.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">78.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">78.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">79.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">79.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">80.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">80.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">81.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">81.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">60.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">70.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">82.0</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</details>
<h3 id="a-grid-of-z-stacks">A grid of Z-stacks<a class="headerlink" href="#a-grid-of-z-stacks" title="Permanent link">#</a></h3>
<p>Here we use <code>axis_order</code> to declare that we want the full Z-stack
to happen at each <code>(row, col)</code> before moving to the next
position in the grid.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDASequence</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">stage_positions</span><span class="o">=</span><span class="p">[{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">}],</span>
    <span class="n">grid_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;fov_width&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&quot;fov_height&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;rows&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">},</span>
    <span class="n">axis_order</span><span class="o">=</span><span class="s2">&quot;pgz&quot;</span>  <span class="c1"># (1)!</span>
<span class="p">)</span>
</code></pre></div>
<ol>
<li>The "fastest" axes come last. By putting <code>z</code> after <code>g</code> in the <code>axis_order</code>,
    we're saying "at each <code>g</code>, do a full <code>z</code> iteration".</li>
</ol>
<details class="example">
<summary>output of <code>list(mda_sequence)</code></summary>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">295.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">297.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">300.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">302.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">305.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">295.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">297.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">300.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">302.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">205.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">305.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">295.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">297.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">300.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">302.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">110.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">305.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">295.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">297.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">300.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">302.5</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">x_pos</span><span class="o">=</span><span class="mf">90.0</span><span class="p">,</span> <span class="n">y_pos</span><span class="o">=</span><span class="mf">195.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">305.0</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</details>
<h3 id="skip-timepoints-or-z-stacks">Skip timepoints or Z-stacks<a class="headerlink" href="#skip-timepoints-or-z-stacks" title="Permanent link">#</a></h3>
<p>The <a href="https://pymmcore-plus.github.io/useq-schema/schema/axes/#useq.Channel"><code>Channel</code> field</a>
has a few tricks, such as skipping timepoints or Z-stacks for specific channels.
Here we take a fast Z-stack (leaving the shutter open) in the <code>FITC</code> channel only, and
a single image in the <code>DIC</code> channel every 3 timepoints:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">useq</span><span class="w"> </span><span class="kn">import</span> <span class="n">MDASequence</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">2.5</span><span class="p">},</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;FITC&quot;</span><span class="p">,</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;DIC&quot;</span><span class="p">,</span> <span class="s2">&quot;acquire_every&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;do_stack&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="p">],</span>
    <span class="n">keep_shutter_open_across</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span>
<span class="p">)</span>
</code></pre></div>
<details class="example">
<summary>output of <code>list(mda_sequence)</code></summary>
<div class="highlight"><pre><span></span><code><span class="p">[</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;DIC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;DIC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">keep_shutter_open</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">MDAEvent</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;FITC&#39;</span><span class="p">,</span> <span class="n">min_start_time</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">z_pos</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="p">]</span>
</code></pre></div>
</details>
<h3 id="a-note-on-syntax">A note on syntax<a class="headerlink" href="#a-note-on-syntax" title="Permanent link">#</a></h3>
<p>If you prefer, you can use <code>useq</code> objects rather than <code>dicts</code>
for all of these fields. This has the advantage of providing
type-checking and auto-completion in your IDE.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>The following two sequences are equivalent:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">useq</span>

<span class="n">mda_sequence1</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">mda_sequence2</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="n">useq</span><span class="o">.</span><span class="n">TIntervalLoops</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loops</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="n">useq</span><span class="o">.</span><span class="n">ZRangeAround</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="n">useq</span><span class="o">.</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="n">exposure</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
        <span class="n">useq</span><span class="o">.</span><span class="n">Channel</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="s2">&quot;FITC&quot;</span><span class="p">,</span> <span class="n">exposure</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="k">assert</span> <span class="n">mda_sequence1</span> <span class="o">==</span> <span class="n">mda_sequence2</span>
</code></pre></div>
</div>
<h2 id="running-an-mda-sequence">Running an MDA sequence<a class="headerlink" href="#running-an-mda-sequence" title="Permanent link">#</a></h2>
<p>You may have noticed above that we could call <code>list()</code> on an instance of
<code>MDASequence</code> to get a list of <code>MDAEvent</code> objects. This means that <code>MDASequence</code>
<strong><em>is</em></strong> an <a href="https://docs.python.org/3/glossary.html#term-iterable">iterable</a> of
<code>MDAEvent</code>... which is exactly what we need to pass to the
<a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.run_mda"><code>run_mda()</code></a> method.</p>
<p>So, you can directly pass an instance of <code>MDASequence</code> to <code>run_mda</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">useq</span>

<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>

<span class="c1"># create a sequence</span>
<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Run it!</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">run_mda</span><span class="p">(</span><span class="n">mda_sequence</span><span class="p">)</span>
</code></pre></div>
<h2 id="handling-acquired-data">Handling acquired data<a class="headerlink" href="#handling-acquired-data" title="Permanent link">#</a></h2>
<p>You will almost certainly want to <em>do</em> something with the
data that is collected during an MDA <img alt="" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@16.0.1/assets/svg/1f602.svg" title=":joy:" />. <code>pymmcore-plus</code>
is relatively agnostic about how acquired data is handled.
There are currently no built-in methods for saving data to
disk in any particular format.</p>
<p>This is partially because there are so many good existing
ways to store array data to disk in Python, including:</p>
<ul>
<li><a href="https://zarr.readthedocs.io/en/stable/">zarr</a></li>
<li><a href="https://github.com/cgohlke/tifffile">tifffile</a></li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.save.html">numpy</a></li>
<li><a href="http://xarray.pydata.org/en/stable/io.html">xarray</a></li>
<li><a href="https://github.com/AllenCellModeling/aicsimageio">aicsimageio</a></li>
</ul>
<p>You will, however, want to know how to connect callbacks to the
<a class="autorefs autorefs-internal" href="../../api/events/#pymmcore_plus.mda.events._protocol.PMDASignaler.frameReady"><code>frameReady</code></a> event, so that you can
handle incoming data as it is acquired:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">useq</span>

<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>

<span class="nd">@mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">frameReady</span><span class="o">.</span><span class="n">connect</span> <span class="c1"># (1)!</span>
<span class="k">def</span><span class="w"> </span><span class="nf">on_frame</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDAEvent</span><span class="p">):</span>
    <span class="c1"># do what you want with the data</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;received frame: </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">image</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;@ index </span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">index</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="n">event</span><span class="o">.</span><span class="n">z_pos</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">mmc</span><span class="o">.</span><span class="n">run_mda</span><span class="p">(</span><span class="n">mda_sequence</span><span class="p">)</span>
</code></pre></div>
<ol>
<li>The <code>frameReady</code> signal accepts a callback with up to two arguments:
   the image data as a numpy array, and the <code>MDAEvent</code> that triggered the callback</li>
</ol>
<p>See also <a class="autorefs autorefs-internal" href="../../api/events/#pymmcore_plus.mda.events.PMDASignaler">additional events you may wish to connect
to</a>.</p>
<h2 id="cancelling-or-pausing">Cancelling or Pausing<a class="headerlink" href="#cancelling-or-pausing" title="Permanent link">#</a></h2>
<p>You can pause or cancel the mda with the
<a class="autorefs autorefs-internal" href="../../api/mda/#pymmcore_plus.mda._runner.MDARunner.toggle_pause"><code>CMMCorePlus.mda.toggle_pause</code></a>
or <a class="autorefs autorefs-internal" href="../../api/mda/#pymmcore_plus.mda._runner.MDARunner.cancel"><code>CMMCorePlus.mda.cancel</code></a>
methods.</p>
<div class="highlight"><pre><span></span><code><span class="n">mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">toggle_pause</span><span class="p">()</span>  <span class="c1"># pauses the mda</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">toggle_pause</span><span class="p">()</span>  <span class="c1"># resumes the mda</span>

<span class="n">mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>  <span class="c1"># cancels the mda</span>
</code></pre></div>
<h2 id="serializing-mda-sequences">Serializing MDA sequences<a class="headerlink" href="#serializing-mda-sequences" title="Permanent link">#</a></h2>
<p><code>MDASequence</code> objects can be serialized and deserialized to and
from JSON or YAML, making it easy to save and load them from
file:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">useq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="p">(</span>
    <span class="n">time_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;loops&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
    <span class="n">z_plan</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;step&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">},</span>
    <span class="n">channels</span><span class="o">=</span><span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;DAPI&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;do_stack&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="s2">&quot;FITC&quot;</span><span class="p">,</span> <span class="s2">&quot;exposure&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
    <span class="p">],</span>
    <span class="n">axis_order</span><span class="o">=</span><span class="s2">&quot;tcz&quot;</span>
<span class="p">)</span>

<span class="n">Path</span><span class="p">(</span><span class="s2">&quot;mda_sequence.yaml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">mda_sequence</span><span class="o">.</span><span class="n">yaml</span><span class="p">())</span>
</code></pre></div>
<p>... results in:</p>
<div class="highlight"><span class="filename">mda_sequence.yaml</span><pre><span></span><code><span class="nt">axis_order</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcz</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAPI</span>
<span class="w">    </span><span class="nt">do_stack</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">exposure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50.0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">FITC</span>
<span class="w">    </span><span class="nt">exposure</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20.0</span>
<span class="nt">time_plan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0:00:02</span>
<span class="w">  </span><span class="nt">loops</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">z_plan</span><span class="p">:</span>
<span class="w">  </span><span class="nt">range</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">  </span><span class="nt">step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
</code></pre></div>
<p>... which can be loaded back into a <code>MDASequence</code> object:</p>
<div class="highlight"><pre><span></span><code><span class="n">mda_sequence</span> <span class="o">=</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDASequence</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s2">&quot;mda_sequence.yaml&quot;</span><span class="p">)</span>
</code></pre></div>
<p>... or even run directly with the <code>mmcore</code> command line:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># use --config to specify a config file for your microscope</span>
$<span class="w"> </span>mmcore<span class="w"> </span>run<span class="w"> </span>mda_sequence.yaml
</code></pre></div>
<h2 id="hardware-triggered-sequences">Hardware-triggered sequences<a class="headerlink" href="#hardware-triggered-sequences" title="Permanent link">#</a></h2>
<p>Having the computer "in-the-loop" for every event in an MDA sequence can add
unwanted overhead that limits performance in rapid acquisition sequences.
Because of this, some devices support <em>hardware triggering</em>. This means that the
computer can tell the device to queue up and start a sequence of events, and the
device will take care of executing the sequence without further input from the
computer.</p>
<p>Just like <a href="https://micro-manager.org/Hardware-based_Synchronization_in_Micro-Manager">micro-manager's acquisition
engine</a>,
the default acquisition engine in <code>pymmcore-plus</code> can opportunistically use
hardware triggering whenever possible. This behavior is on by default, but you can
disable it by setting <code>CMMCorePlus.mda.engine.use_hardware_sequencing = False</code>,
which may be useful for various debugging or testing purposes:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>

<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>

<span class="c1"># enable hardware triggering</span>
<span class="c1"># this is True by default, this is just an example for how to set it</span>
<span class="n">mmc</span><span class="o">.</span><span class="n">mda</span><span class="o">.</span><span class="n">engine</span><span class="o">.</span><span class="n">use_hardware_sequencing</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<div class="admonition question">
<p class="admonition-title">How does pymmcore-plus know if my device supports hardware triggering?</p>
<p>The low-level <code>CMMCore</code> object itself has a number of methods that query
whether certain devices are capable of hardware triggering, such as</p>
<ul>
<li><a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore.CMMCore.isStageSequenceable"><code>pymmcore.CMMCore.isStageSequenceable</code></a></li>
<li><a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore.CMMCore.isPropertySequenceable"><code>pymmcore.CMMCore.isPropertySequenceable</code></a></li>
<li><a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore.CMMCore.isXYStageSequenceable"><code>pymmcore.CMMCore.isXYStageSequenceable</code></a></li>
<li><a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore.CMMCore.isExposureSequenceable"><code>pymmcore.CMMCore.isExposureSequenceable</code></a></li>
</ul>
<p>Hint: Many devices that support sequencing have a property (often named
<code>Sequence</code> or similar) that can be used to toggle their responses to the
above queries, thereby enabling or disabling sequencing.</p>
<p>If two <code>MDAEvents</code> in a sequence have different exposure, stage, or other
device property values, then <code>pymmcore-plus</code> uses these methods to determine whether the
events can be sequenced (see <a class="autorefs autorefs-internal" href="../../api/cmmcoreplus/#pymmcore_plus.core._mmcore_plus.CMMCorePlus.canSequenceEvents"><code>pymmcore_plus.CMMCorePlus.canSequenceEvents</code></a>).
If they can, then the events are grouped together
and executed as a single hardware-triggered sequence.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pymmcore_plus</span><span class="w"> </span><span class="kn">import</span> <span class="n">CMMCorePlus</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">useq</span>

<span class="n">mmc</span> <span class="o">=</span> <span class="n">CMMCorePlus</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

<span class="n">mmc</span><span class="o">.</span><span class="n">loadSystemConfiguration</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mmc</span><span class="o">.</span><span class="n">canSequenceEvents</span><span class="p">(</span><span class="n">useq</span><span class="o">.</span><span class="n">MDAEvent</span><span class="p">(),</span> <span class="n">useq</span><span class="o">.</span><span class="n">MDAEvent</span><span class="p">()))</span>  <span class="c1"># True</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mmc</span><span class="o">.</span><span class="n">canSequenceEvents</span><span class="p">(</span>
    <span class="n">useq</span><span class="o">.</span><span class="n">MDAEvent</span><span class="p">(</span><span class="n">exposure</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">54</span><span class="p">),</span>
    <span class="n">useq</span><span class="o">.</span><span class="n">MDAEvent</span><span class="p">(</span><span class="n">exposure</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_pos</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="p">))</span>  <span class="c1"># False, unless you have stage and exposure hardware triggering</span>
</code></pre></div>
</div>
<h2 id="next-steps">Next steps<a class="headerlink" href="#next-steps" title="Permanent link">#</a></h2>
<p>Now that you have a basic understanding of how to create and run
multi-dimensional acquisition sequences in pymmcore-plus, you may want to
take a look at some more advanced features:</p>
<ul>
<li><a href="../custom_engine/">customizing the acquisition engine</a></li>
<li><a href="../event_driven_acquisition/">creating non-deterministic sequences for event-driven
  acquisition</a></li>
</ul>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../events/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Events and Callbacks">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Events and Callbacks
              </div>
            </div>
          </a>
        
        
          
          <a href="../custom_engine/" class="md-footer__link md-footer__link--next" aria-label="Next: Custom Acquisition Engines">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Custom Acquisition Engines
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.tabs.link", "content.code.annotate", "content.code.copy", "navigation.tabs", "navigation.footer"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>